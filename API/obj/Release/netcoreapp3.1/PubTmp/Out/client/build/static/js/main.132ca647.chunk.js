(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{144:function(e,a,t){"use strict";t.r(a);var s=t(0),n=t.n(s),r=t(24),o=t.n(r),l=(t(26),t(21)),c=t(6);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var i=t(14),m=t(15),u=t(17),d=t(16),g=function(e){Object(u.a)(t,e);var a=Object(d.a)(t);function t(){return Object(i.a)(this,t),a.apply(this,arguments)}return Object(m.a)(t,[{key:"render",value:function(){var e=this.props.component,a=localStorage.getItem("session_id");return console.log(a),null!==a?n.a.createElement(e,null):n.a.createElement(c.a,{to:{pathname:"/login"}})}}]),t}(s.Component),h=t(18),p=(t(38),t(146)),E=t(147),f=t(62),b=t(149),w=t(150),I=t(12),v=t.n(I),N=(t(47),function(e){Object(u.a)(t,e);var a=Object(d.a)(t);function t(){var e;return Object(i.a)(this,t),(e=a.call(this)).handleChange=function(a){var t,s=a.target,n=s.name,r=s.value;e.setState((t={},Object(h.a)(t,n,r),Object(h.a)(t,"errorMessage",""),Object(h.a)(t,"logInErrorMessage",""),t))},e.handleNewUserSubmit=function(a){a.preventDefault(),e.postNewUser()},e.handleLogInSubmit=function(a){a.preventDefault(),e.logInUser()},e.redirectUser=function(){if(!0===e.state.toChatRoom)return n.a.createElement(c.a,{to:"/"})},e.postNewUser=function(){v.a.post("/api/register",{username:e.state.newUsername,password:e.state.newPassword}).then((function(e){localStorage.setItem("session_id",e.data.id),localStorage.setItem("user_id",e.data.userId)})).catch((function(a){"empty username"===a.response.data.title&&e.setState({errorMessage:"Please choose a username."}),"empty password"===a.response.data.title&&e.setState({errorMessage:"Please choose a password."}),"redundant username"===a.response.data.title&&e.setState({errorMessage:"The username you chose is already taken.  Please try another entry."})}))},e.logInUser=function(){v.a.post("/api/authorize",{username:e.state.existingUsername,password:e.state.existingPassword}).then((function(a){console.log(a.data),localStorage.setItem("session_id",a.data.id),localStorage.setItem("user_id",a.data.userId),e.setState({toChatRoom:!0})})).catch((function(a){"empty username"===a.response.data.title&&e.setState({logInErrorMessage:"Please enter a username."}),"empty password"===a.response.data.title&&e.setState({logInErrorMessage:"Please enter a password."}),"false username"===a.response.data.title&&e.setState({logInErrorMessage:"The username you chose is already taken.  Please try another entry."}),"wrong credentials"===a.response.data.title&&e.setState({logInErrorMessage:"Username or password are invalid."})}))},e.state={newUsername:"",newPassword:"",existingUsername:"",existingPassword:"",errorMessage:"",logInErrorMessage:"",toChatRoom:!1},e}return Object(m.a)(t,[{key:"render",value:function(){return console.log(this.state.toChatRoom),!0===this.state.toChatRoom?n.a.createElement(c.a,{to:"/"}):n.a.createElement("div",{className:"main-container"},n.a.createElement(p.a,{className:"top-container",fluid:!0},n.a.createElement(E.a,{className:"h-100"},n.a.createElement(f.a,{className:"gab-column"},n.a.createElement("h1",{className:"gab-logo"},n.a.createElement("span",{className:"purple-gab"},"The Gab")," Chat Room")),n.a.createElement(f.a,null,n.a.createElement(b.a,{className:"sign-in-form",onSubmit:this.handleLogInSubmit},n.a.createElement(b.a.Row,{className:"sign-in-row"},n.a.createElement(f.a,{className:"col-xs-5 username-col"},n.a.createElement(b.a.Label,{className:"top-form-label"},"Username"),n.a.createElement(b.a.Control,{type:"input",className:"input-sign-in",onChange:this.handleChange,name:"existingUsername"})),n.a.createElement(f.a,{className:"col-xs-5 password-col"},n.a.createElement(b.a.Label,{className:"top-form-label"},"Password"),n.a.createElement(b.a.Control,{type:"input",className:"input-sign-in",onChange:this.handleChange,name:"existingPassword"})),n.a.createElement(w.a,{className:"login-btn",variant:"dark",type:"submit"},n.a.createElement("h6",{className:"text-center login-text"},"Log In")),n.a.createElement("h6",null,this.state.logInErrorMessage)))))),n.a.createElement(p.a,{className:"bottom-container",fluid:!0},n.a.createElement(E.a,{className:"w-100"},n.a.createElement(f.a,{className:"w-100"},n.a.createElement("h1",{className:"join-text"},"Join The Gab Community"),n.a.createElement("h2",{className:"painless-text"},"It's quick and painless."))),n.a.createElement("br",null),n.a.createElement(E.a,null,n.a.createElement(f.a,null,n.a.createElement(b.a,{className:"mt-3 sign-up-form",onSubmit:this.handleNewUserSubmit},n.a.createElement(b.a.Group,{controlId:"formBasicEmail"},n.a.createElement(b.a.Label,null,"Choose username"),n.a.createElement(b.a.Control,{type:"input",placeholder:"Enter a new username",name:"newUsername",onChange:this.handleChange})),n.a.createElement(b.a.Group,{controlId:"formBasicPassword"},n.a.createElement(b.a.Label,null,"Choose password"),n.a.createElement(b.a.Control,{type:"password",placeholder:"Enter a new password",name:"newPassword",onChange:this.handleChange})),n.a.createElement(w.a,{variant:"light",type:"submit"},"Submit")),n.a.createElement("br",null),n.a.createElement("h2",{className:"text-center error-text"},this.state.errorMessage))),n.a.createElement("div",{className:"container-fluid footer-container"},n.a.createElement("footer",null,n.a.createElement("h6",{className:"text-center footer-text mt-2"},"Copyright Reid Muchow 2020")))))}}]),t}(s.Component)),y=t(148),S=t(63),C=t.n(S),x=function(e){Object(u.a)(t,e);var a=Object(d.a)(t);function t(){var e;return Object(i.a)(this,t),(e=a.call(this)).getMessagesFromDatabase=function(){v.a.get("/api/messages",{}).then((function(a){var t=a.data.sort((function(e,a){return new Date(a.createdDate)+new Date(e.createdDate)}));e.setState({messages:t})}))},e.getUsers=function(){v.a.get("/api/users",{}).then((function(a){console.log(a),e.setState({users:a.data})}))},e.putNewUserName=function(){var a=parseInt(localStorage.getItem("user_id"));v.a.put("/api/users",{userId:a,newUsername:e.state.newUsername}).then((function(a){console.log(a),e.getUsers()}))},e.postNewMessage=function(){var a=parseInt(localStorage.getItem("session_id")),t=parseInt(localStorage.getItem("user_id"));v.a.post("/api/messages",{sessionId:a,userId:t,text:e.state.messageInput}).then((function(a){var t=a.data.sort((function(e,a){return new Date(a.createdDate)+new Date(e.createdDate)}));e.setState({messages:t})}))},e.handleChange=function(a){var t=a.target,s=t.name,n=t.value;e.setState(Object(h.a)({},s,n))},e.handleSubmit=function(a){a.preventDefault(),e.postNewMessage(),e.addLastActive(),e.getMessagesFromDatabase(),e.clearInput()},e.handleClick=function(){localStorage.removeItem("session_id"),localStorage.removeItem("user_id"),e.setState({isLoggedIn:!1})},e.onKeyPress=function(a){13===a.which&&(a.preventDefault(),e.postNewMessage(),e.getMessagesFromDatabase(),e.clearInput())},e.clearInput=function(){e.setState({messageInput:""})},e.addLastActive=function(){var e=parseInt(localStorage.getItem("user_id"));v.a.put("/api/users/last_active",{userId:e}).then((function(e){console.log(e)}))},e.state={users:[],messages:[],messageInput:"",isLoggedIn:!0,sessionId:0},e}return Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this,a=localStorage.getItem("session_id");this.addLastActive(),setInterval((function(){e.getMessagesFromDatabase()}),2e3),setInterval((function(){e.getUsers()}),5e3),this.getUsers(),this.setState({sessionId:a})}},{key:"render",value:function(){console.log(this.getMessagesFromDatabase);localStorage.getItem("user_id");if(!1===this.state.isLoggedIn)return n.a.createElement(c.a,{to:"/login"});var e=this.state.users.map((function(e,a){return n.a.createElement("div",{key:a},n.a.createElement(y.a,{className:"ml-2 d-inline-block",color:"white",width:"12",height:"12"}),n.a.createElement("h6",{className:"d-inline-block ml-2"},e.username))})),a=this.state.messages.map((function(e){return n.a.createElement("div",{className:"card message-card",style:{width:"40rem"},key:e.createdDate},n.a.createElement("div",{className:"card-body"},n.a.createElement("h6",{className:"card-title"},e.username),n.a.createElement("p",{className:"card-text"},e.text)))}));return n.a.createElement("div",{className:"container"},n.a.createElement("div",{className:"row justify-content-center h-100 main-row"},n.a.createElement("div",{className:"col-xs h-100 w-25 users-col"},n.a.createElement("h5",{className:"d-inline-block users-header"},"Users"),n.a.createElement("a",{href:"",onClick:this.handleClick,className:"d-inline-block justify-content-right log-out-button",variant:"secondary",size:"sm"},"Log Out"),n.a.createElement("hr",{className:"users-border"}),n.a.createElement("br",null),this.sortedDates,e),n.a.createElement(C.a,{className:"h-100 messages-col mt-5"},a),n.a.createElement(f.a,{className:"col-8"},n.a.createElement("form",{onSubmit:this.handleSubmit,onKeyPress:this.onKeyPress},n.a.createElement(b.a.Group,{controlId:"exampleForm.ControlTextarea1",className:"textarea-form"},n.a.createElement(b.a.Control,{className:"message-input",value:this.state.messageInput,type:"input",onChange:this.handleChange,name:"messageInput",placeholder:"Type Message Here",as:"textarea",rows:"3"}),n.a.createElement(w.a,{className:"mt-1 d-block messages-submit",type:"submit",variant:"outline-dark"},"Submit"))))))}}]),t}(s.Component);o.a.render(n.a.createElement(l.a,null,n.a.createElement(c.d,null,n.a.createElement(c.b,{path:"/login",component:N}),n.a.createElement(g,{exact:!0,path:"/",component:x}),n.a.createElement(g,{component:x}))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},26:function(e,a,t){},65:function(e,a,t){e.exports=t(144)}},[[65,1,2]]]);
//# sourceMappingURL=main.132ca647.chunk.js.map